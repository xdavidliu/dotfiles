#!/usr/bin/env bash

# if change filename, also change in bindings.el
BASH_REMINDERS=~/Documents/bash-reminders.txt
if [ -f "$BASH_REMINDERS" ]; then
  cat $BASH_REMINDERS
fi

p () {
  # usage: path foo.txt
  FILE="$(readlink -f $1)"
  printf "$FILE\ncopied to clipboard\n"
  printf "$FILE" | xsel -bi
}

h () {
  if command -v $1 > /dev/null; then
    $1 --help | less
  else
    echo "command $1 doesn't exist"
  fi
}

# the if statement checks if we are on a laptop
# this works for Debian at least, not sure if works for Arch
# superuser.com/questions/877677/
# the commented out version below gave false positive for desktop ubuntu
# if [ -d /sys/module/battery ]; then

if [ -d /proc/acpi/battery/BAT* ]; then
  # display battery percentage before each PS1
  PROMPT_COMMAND='echo -n $(</sys/class/power_supply/BAT0/capacity)'
  night () {
    local temp=${2:-4800}
    local bright=${1:-1}
    redshift -P -O $temp -b $bright > /dev/null
    echo "setting color temperature to $temp"
    echo "setting brightness to $bright"
    echo "if brightness is less than 1, make sure 'dim 1' is done first"
  }
  dim () {
    local FILE=/sys/class/backlight/intel_backlight/brightness
    echo "current brightness is $(cat $FILE)"
    if [ $# -ne 0 ]; then
      echo "setting brightness to $1..."
      sudo su -c "echo $1 > $FILE"
      echo 'done!'
    fi
  }
fi

current_window_class_has_substring () {
  local id=`xdotool getactivewindow`
  if xprop WM_CLASS -id $id | grep $1 > /dev/null; then
    return 0 # true
  else
    return 1 # false
  fi
}

chrome-window-active () {
  if current_window_class_has_substring chrome; then
    return 0
  else
    return 1
  fi
}
